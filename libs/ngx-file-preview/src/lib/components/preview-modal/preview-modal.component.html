<div class="preview-modal-overlay" *ngIf="isVisible" (click)="close()">
  <div class="preview-modal-content"
       (click)="$event.stopPropagation()"
       (mousemove)="handleMouseMove()"
       (mouseleave)="hideControls()">
    <div class="preview-modal-header" [class.has-multiple]="hasMultipleFiles">
      <div class="header-left">
        <span class="file-name">{{ currentFile?.name }}</span>
        <span class="file-index" *ngIf="hasMultipleFiles">{{ getCurrentFileInfo() }}</span>
      </div>
      <div class="header-right">
        <div class="theme-toggle" (click)="toggleTheme()">
         <ngx-theme-icon [themeMode]="theme$|async"></ngx-theme-icon>
        </div>
        <preview-icon name="close" [themeMode]="theme$|async" (click)="close()"></preview-icon>
      </div>
    </div>
    <div class="preview-modal-body">
      <button class="nav-button prev"
              *ngIf="canShowPrevious()"
              [class.visible]="isControlsVisible"
              (click)="previous()">
        <preview-icon [themeMode]="themeMode" [size]="36" name="previous"></preview-icon>
      </button>

      <div class="preview-content">
        <ng-container [ngSwitch]="currentFile?.type">
          <ngx-image-preview
            *ngSwitchCase="'image'"
            [file]="currentFile!"
            [themeMode]="theme$|async"
          ></ngx-image-preview>

          <ngx-video-preview
            *ngSwitchCase="'video'"
            [file]="currentFile!"
            [themeMode]="theme$|async"
          ></ngx-video-preview>

          <ngx-pdf-preview
            *ngSwitchCase="'pdf'"
            [file]="currentFile!"
            [themeMode]="theme$|async"
          ></ngx-pdf-preview>

          <ngx-word-preview
            *ngSwitchCase="'word'"
            [file]="currentFile!"
            [themeMode]="theme$|async"
          ></ngx-word-preview>

          <ngx-excel-preview
            *ngSwitchCase="'excel'"
            [file]="currentFile!"
            [themeMode]="theme$|async"
          ></ngx-excel-preview>

          <ngx-ppt-preview
            *ngSwitchCase="'ppt'"
            [file]="currentFile!"
            [themeMode]="theme$|async"
          ></ngx-ppt-preview>

          <ngx-text-preview
            *ngSwitchCase="'txt'"
            [file]="currentFile!"
            [themeMode]="theme$|async"
          ></ngx-text-preview>

          <ngx-markdown-preview
            *ngSwitchCase="'markdown'"
            [file]="currentFile!"
            [themeMode]="theme$|async"
          ></ngx-markdown-preview>

          <ngx-archive-preview
            *ngSwitchCase="'zip'"
            [file]="currentFile!"
            [themeMode]="theme$|async"
          ></ngx-archive-preview>

          <ngx-audio-preview
            *ngSwitchCase="'audio'"
            [file]="currentFile!"
            [themeMode]="theme$|async"
          ></ngx-audio-preview>

          <ngx-unknown-preview
            *ngSwitchCase="'unknown'"
            [file]="currentFile!">
            [themeMode]="theme$|async"
          </ngx-unknown-preview>
        </ng-container>
      </div>

      <button class="nav-button next"
              *ngIf="canShowNext()"
              [class.visible]="isControlsVisible"
              (click)="next()">
        <preview-icon [themeMode]="themeMode" [size]="36" name="next"></preview-icon>
      </button>
    </div>
  </div>
</div>
